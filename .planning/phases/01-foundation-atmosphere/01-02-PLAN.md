---
phase: 01-foundation-atmosphere
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - client/src/components/background/HillsLayer.tsx
  - client/src/components/background/TreesLayer.tsx
  - client/src/components/background/CabinLayer.tsx
  - client/src/components/background/ParallaxBackground.tsx
autonomous: true

must_haves:
  truths:
    - "Three distinct SVG layers create visible depth with parallax motion"
    - "Cabin visual is always visible in the background as emotional anchor"
    - "Background layers use navy-to-slate gradient palette establishing moody atmosphere"
  artifacts:
    - path: "client/src/components/background/ParallaxBackground.tsx"
      provides: "Parallax container with CSS 3D transforms"
      min_lines: 15
    - path: "client/src/components/background/HillsLayer.tsx"
      provides: "Furthest SVG layer - rolling snow hills"
      min_lines: 15
    - path: "client/src/components/background/TreesLayer.tsx"
      provides: "Middle SVG layer - pine tree silhouettes"
      min_lines: 15
    - path: "client/src/components/background/CabinLayer.tsx"
      provides: "Nearest SVG layer - cabin with chimney smoke and warm glow"
      min_lines: 20
  key_links:
    - from: "client/src/components/background/ParallaxBackground.tsx"
      to: "HillsLayer, TreesLayer, CabinLayer"
      via: "React component composition"
      pattern: "import.*Layer"
    - from: "client/src/components/background/ParallaxBackground.tsx"
      to: "CSS 3D transforms"
      via: "translateZ for depth"
      pattern: "translateZ"
---

<objective>
Create the parallax SVG background that establishes FRACTAL's moody winter atmosphere from the first moment the app loads.

Purpose: The parallax background is the emotional foundation of the entire experience. Three SVG layers (snow hills, pine trees, cabin) at different depths create visual richness that separates this from a generic hackathon project. The cabin with its warm glow is the emotional anchor - always visible, always inviting. This is what judges see first.

Output: A ParallaxBackground component with three atmospheric SVG layers using CSS 3D transforms for depth, positioned behind all other content via the z-index layer system.
</objective>

<execution_context>
@/Users/sahilpatel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sahilpatel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-atmosphere/01-RESEARCH.md
@.planning/phases/01-foundation-atmosphere/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create three atmospheric SVG layer components</name>
  <files>
    client/src/components/background/HillsLayer.tsx
    client/src/components/background/TreesLayer.tsx
    client/src/components/background/CabinLayer.tsx
  </files>
  <action>
    Create three SVG layer components. Each renders an inline SVG with viewBox="0 0 1920 1080" and preserveAspectRatio="xMidYMax slice" to cover the viewport. Use the project's color palette from Tailwind config.

    **HillsLayer.tsx** (furthest layer - rolling snow hills):
    - Render 3-4 overlapping rounded hill shapes using SVG `<path>` elements with smooth bezier curves
    - Colors: gradient from slate-800 (#1e293b) at the top to slate-700 (#334155) at the hill peaks
    - Hills should fill the bottom 40-60% of the viewport
    - Add a subtle radial gradient at the top for sky-to-hill transition
    - Use a linear gradient from `#0f172a` (sky) to `#1e293b` (horizon) for the sky portion
    - Keep SVG simple: <10 path elements total (performance per research)

    **TreesLayer.tsx** (middle layer - pine tree silhouettes):
    - Render 8-12 pine tree silhouettes as simple triangular SVG shapes along a horizon line
    - Trees should vary in height (40-120px equivalent) and spacing for natural feel
    - Color: slate-700 (#334155) or slate-600 (#475569) silhouettes - slightly lighter than hills to create depth
    - Trees positioned in the bottom 30-50% of the viewport
    - Use simple triangle `<polygon>` or `<path>` elements, NOT complex detailed trees
    - Add thin trunk rectangles beneath each tree

    **CabinLayer.tsx** (nearest layer - cabin with warm glow):
    - Render a simple cabin shape: rectangular body + triangular roof using SVG `<rect>` and `<polygon>`
    - Position cabin at bottom-right area (roughly 70-80% from left, sitting on bottom edge)
    - Cabin body color: slate-600 (#475569) with darker slate-700 roof
    - Add 1-2 small window rectangles filled with amber-400 (#fbbf24) for warm glow effect
    - Add a chimney (small rectangle on roof) with animated smoke:
      - Smoke: 2-3 small `<circle>` or `<ellipse>` elements in slate-400 (#94a3b8) with opacity 0.3-0.6
      - Animate smoke with CSS keyframes: gentle upward drift + fade out + slight horizontal sway
    - Add a soft radial gradient `<circle>` behind windows in amber-500 (#f59e0b) at opacity 0.15-0.2 for ambient cabin glow
    - The cabin is the emotional anchor - it should feel warm and inviting against the cold landscape

    Each component should:
    - Export a named function component (not default export)
    - Accept no props (self-contained visuals)
    - Use `className="w-full h-full"` on the root SVG
    - Include the smoke animation CSS as a `<style>` tag inside the SVG for CabinLayer
    - Keep total SVG elements under 30 per layer for performance
  </action>
  <verify>
    Each file imports and exports without TypeScript errors: `cd client && npx tsc --noEmit`
    Each component can be rendered in isolation (temporarily import into App.tsx and verify SVG renders).
  </verify>
  <done>
    Three SVG layer components exist with atmospheric winter visuals. Hills show rolling snow shapes in slate tones. Trees show pine silhouettes along horizon. Cabin shows a warm-glowing shelter with animated chimney smoke. All use the project color palette.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ParallaxBackground container with CSS 3D depth transforms</name>
  <files>
    client/src/components/background/ParallaxBackground.tsx
  </files>
  <action>
    Create the ParallaxBackground component that composes all three SVG layers with CSS 3D parallax depth.

    Use the pure CSS parallax approach from research (Keith Clark method):

    ```tsx
    import { HillsLayer } from './HillsLayer'
    import { TreesLayer } from './TreesLayer'
    import { CabinLayer } from './CabinLayer'

    export function ParallaxBackground() {
      return (
        <div
          className="fixed inset-0 pointer-events-none"
          style={{ zIndex: 'var(--z-background)' }}
        >
          {/* Sky gradient base */}
          <div
            className="absolute inset-0"
            style={{
              background: 'linear-gradient(180deg, #0f172a 0%, #1e293b 60%, #334155 100%)',
            }}
          />

          {/* Furthest layer - hills (slowest movement) */}
          <div
            className="absolute inset-0"
            style={{ transform: 'translateZ(-2px) scale(3)' }}
          >
            <HillsLayer />
          </div>

          {/* Middle layer - trees */}
          <div
            className="absolute inset-0"
            style={{ transform: 'translateZ(-1px) scale(2)' }}
          >
            <TreesLayer />
          </div>

          {/* Nearest layer - cabin (fastest movement, most prominent) */}
          <div
            className="absolute inset-0"
            style={{ transform: 'translateZ(-0.5px) scale(1.5)' }}
          >
            <CabinLayer />
          </div>
        </div>
      )
    }
    ```

    Important implementation notes:
    - Use `fixed inset-0` positioning so background stays behind React Flow canvas
    - Use `pointer-events-none` so clicks pass through to the canvas layer
    - Use CSS variable `var(--z-background)` for z-index (value: 0)
    - The perspective/translateZ approach creates natural parallax when combined with React Flow's viewport transforms
    - Do NOT use `overflow: hidden` on the container (breaks CSS 3D transforms per research)
    - Since this is a full-screen app (not scroll-based), the parallax depth creates visual layering rather than scroll-driven motion. The layers at different translateZ values will appear to move at different speeds when the user pans the React Flow canvas, creating subtle depth perception.
    - If the CSS 3D approach doesn't create visible parallax effect in a non-scrolling context, simplify to static positioned layers with slight scale differences and opacity variation for depth. The visual depth matters more than the parallax technique.

    Export as named export from the file.
  </action>
  <verify>
    `cd client && npx tsc --noEmit` compiles without errors.
    Temporarily render `<ParallaxBackground />` in App.tsx:
    - Background gradient visible (navy to slate)
    - Hills visible in lower portion
    - Trees visible as silhouettes
    - Cabin visible with glowing windows and animated smoke
    - All layers stack correctly (hills behind trees behind cabin)
    - Clicking through the background reaches underlying content (pointer-events-none works)
  </verify>
  <done>
    ParallaxBackground renders three atmospheric SVG layers with visible depth separation. Cabin glow and chimney smoke animation are visible. Background does not intercept pointer events. Z-index places it behind all other content layers.
  </done>
</task>

</tasks>

<verification>
1. `cd client && npx tsc --noEmit` passes with zero errors
2. ParallaxBackground renders all three layers visibly
3. Cabin windows glow with amber warmth
4. Chimney smoke animates (gentle upward drift)
5. Sky gradient transitions from dark navy to lighter slate
6. Layers have visible depth separation (hills furthest, cabin nearest)
7. `pointer-events-none` allows clicks to pass through
</verification>

<success_criteria>
- Three SVG background layers render atmospheric winter scene
- Cabin is always visible with warm glowing windows (emotional anchor)
- Chimney smoke animates smoothly
- Background uses z-index layer 0 (behind canvas)
- No pointer event interference with content above
- Color palette matches design system (navy/slate + amber glow)
- SVG performance is smooth (under 30 elements per layer)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-atmosphere/01-02-SUMMARY.md`
</output>
